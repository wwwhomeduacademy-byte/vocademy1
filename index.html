<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Drag & Drop Game</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&display=swap');

  :root {
    --bg:      #0a0a0f;
    --surface: #12121a;
    --sur2:    #1c1c28;
    --border:  #2a2a3f;
    --accent:  #7c5cfc;
    --accent2: #fc5c7d;
    --green:   #5cfca2;
    --text:    #e8e8f0;
    --muted:   #6b6b8a;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    font-family: 'Space Mono', monospace;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    padding: 20px;
    display: flex;
    flex-direction: column;
    gap: 16px;
  }

  .header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: 10px;
  }
  .game-title { font-size: 15px; font-weight: 700; color: var(--text); }
  .score-box {
    font-size: 13px;
    background: var(--sur2);
    border: 1px solid var(--border);
    padding: 6px 14px;
    border-radius: 20px;
  }
  .score-box span { color: var(--accent); font-weight: 700; }

  .progress { height: 4px; background: var(--border); border-radius: 2px; }
  .progress-fill {
    height: 100%; border-radius: 2px;
    background: linear-gradient(90deg, var(--accent), var(--accent2));
    transition: width .4s cubic-bezier(.34,1.56,.64,1);
    width: 0%;
  }

  .modes { display: flex; gap: 8px; flex-wrap: wrap; }
  .mode-btn {
    padding: 7px 14px; border-radius: 8px; font-size: 11px;
    font-family: 'Space Mono', monospace; cursor: pointer;
    border: 1px solid var(--border); background: var(--sur2);
    color: var(--muted); transition: all .2s;
  }
  .mode-btn:hover { border-color: var(--accent); color: var(--text); }
  .mode-btn.active { background: var(--accent); color: white; border-color: var(--accent); }

  .tokens { display: flex; flex-wrap: wrap; gap: 10px; min-height: 46px; }
  .token {
    padding: 10px 18px;
    background: var(--sur2); border: 1px solid var(--border);
    border-radius: 30px; font-size: 12px; cursor: grab;
    user-select: none; touch-action: none;
    transition: transform .15s, box-shadow .15s, border-color .15s;
  }
  .token:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 24px rgba(124,92,252,.35);
    border-color: var(--accent);
  }
  .token.dragging { opacity: 0; pointer-events: none; }
  .token.used     { opacity: .3; pointer-events: none; }

  .zones { display: flex; flex-wrap: wrap; gap: 10px; }
  .zone {
    flex: 1; min-width: 110px; min-height: 70px;
    border: 2px dashed var(--border); border-radius: 12px;
    display: flex; flex-direction: column;
    align-items: center; justify-content: center;
    padding: 10px; transition: all .2s; text-align: center;
  }
  .zone-lbl {
    font-size: 10px; color: var(--muted);
    text-transform: uppercase; letter-spacing: 1px; margin-bottom: 6px;
  }
  .zone-val { font-size: 12px; color: var(--muted); }
  .zone.over    { border-color: var(--accent); background: rgba(124,92,252,.08); }
  .zone.correct { border-color: var(--green);  background: rgba(92,252,162,.08); border-style: solid; }
  .zone.wrong   { border-color: var(--accent2); background: rgba(252,92,125,.08); animation: shake .3s; }

  @keyframes shake {
    0%,100% { transform: translateX(0); }
    25%      { transform: translateX(-8px); }
    75%      { transform: translateX(8px); }
  }

  #ghost {
    position: fixed; pointer-events: none; z-index: 9999;
    padding: 10px 18px;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    border-radius: 30px; font-family: 'Space Mono', monospace;
    font-size: 12px; color: white;
    box-shadow: 0 12px 40px rgba(124,92,252,.5);
    transform: translate(-50%, -50%) rotate(-3deg) scale(1.05);
    display: none;
  }

  #toast {
    position: fixed; bottom: 24px; left: 50%;
    transform: translateX(-50%);
    padding: 10px 22px; border-radius: 10px;
    font-size: 13px; font-weight: 700;
    pointer-events: none; opacity: 0;
    transition: opacity .3s; z-index: 9998; white-space: nowrap;
  }
  #toast.show { opacity: 1; }
  #toast.win  { background: rgba(92,252,162,.15); border: 1px solid var(--green);   color: var(--green); }
  #toast.lose { background: rgba(252,92,125,.15); border: 1px solid var(--accent2); color: var(--accent2); }

  .reset-btn {
    align-self: flex-end; padding: 8px 18px; border-radius: 8px;
    font-size: 11px; font-family: 'Space Mono', monospace; cursor: pointer;
    border: 1px solid var(--border); background: var(--sur2);
    color: var(--muted); transition: all .2s;
  }
  .reset-btn:hover { border-color: var(--accent2); color: var(--accent2); }
</style>
</head>
<body>

<div id="ghost"></div>
<div id="toast"></div>

<div class="header">
  <div class="game-title" id="gameTitle">Ã‡iftleri EÅŸleÅŸtir</div>
  <div class="score-box">Puan: <span id="scoreEl">0</span></div>
</div>

<div class="progress"><div class="progress-fill" id="progressEl"></div></div>

<div class="modes">
  <button class="mode-btn active" data-mode="match">EÅŸleÅŸtir</button>
  <button class="mode-btn" data-mode="sort">SÄ±nÄ±flandÄ±r</button>
  <button class="mode-btn" data-mode="order">SÄ±rala</button>
  <button class="mode-btn" data-mode="fill">BaÅŸkentler</button>
</div>

<div class="tokens" id="tokens"></div>
<div class="zones"  id="zones"></div>

<button class="reset-btn" id="resetBtn">â†º Yeniden BaÅŸla</button>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  OYUN VERÄ°SÄ° â€” buradan Ã¶zelleÅŸtirin
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const GAMES = {
  match: {
    title: 'Ã‡iftleri EÅŸleÅŸtir',
    items: [
      { token: 'Kedi',  zone: 'Miyav' },
      { token: 'KÃ¶pek', zone: 'Hav'   },
      { token: 'Ä°nek',  zone: 'MÃ¶Ã¶'   },
      { token: 'KuÅŸ',   zone: 'Cik'   },
    ],
  },
  sort: {
    title: 'Kategoriye GÃ¶re SÄ±nÄ±flandÄ±r',
    categories: ['Meyve', 'Sebze'],
    items: [
      { token: 'Elma',    zone: 'Meyve' },
      { token: 'GÃ¼l',     zone: 'Sebze' },
      { token: 'HavuÃ§',   zone: 'Sebze' },
      { token: 'Kiraz',   zone: 'Meyve' },
      { token: 'Bezelye', zone: 'Sebze' },
      { token: 'Mango',   zone: 'Meyve' },
    ],
  },
  order: {
    title: 'DoÄŸru SÄ±raya Diz',
    items: [
      { token: '3.', zone: 'SÄ±ra 1' },
      { token: '1.', zone: 'SÄ±ra 2' },
      { token: '4.', zone: 'SÄ±ra 3' },
      { token: '2.', zone: 'SÄ±ra 4' },
    ],
    zones: ['SÄ±ra 1', 'SÄ±ra 2', 'SÄ±ra 3', 'SÄ±ra 4'],
    correctOrder: { '1.': 'SÄ±ra 1', '2.': 'SÄ±ra 2', '3.': 'SÄ±ra 3', '4.': 'SÄ±ra 4' },
  },
  fill: {
    title: 'BaÅŸkenti EÅŸleÅŸtir',
    items: [
      { token: 'Paris',  zone: 'Fransa'   },
      { token: 'Tokyo',  zone: 'Japonya'  },
      { token: 'Berlin', zone: 'Almanya'  },
      { token: 'Kahire', zone: 'MÄ±sÄ±r'    },
      { token: 'Ankara', zone: 'TÃ¼rkiye'  },
    ],
  },
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ENGINE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

let state = {};
let ghost = document.getElementById('ghost');
let draggingEl = null;

function shuffle(a) { return a.sort(() => Math.random() - .5); }

function init(mode) {
  const g = GAMES[mode];
  state = { mode, score: 0, correct: 0, total: 0, pairs: {} };

  document.getElementById('gameTitle').textContent  = g.title;
  document.getElementById('scoreEl').textContent    = '0';
  document.getElementById('progressEl').style.width = '0%';

  if (mode === 'order') {
    state.pairs = { ...g.correctOrder };
  } else {
    g.items.forEach(it => state.pairs[it.token] = it.zone);
  }

  const tokensEl = document.getElementById('tokens');
  tokensEl.innerHTML = '';
  const tokens = shuffle(g.items.map(it => it.token));
  state.total = tokens.length;
  tokens.forEach(name => {
    const el = document.createElement('div');
    el.className    = 'token';
    el.textContent  = name;
    el.dataset.name = name;
    tokensEl.appendChild(el);
  });

  const zonesEl = document.getElementById('zones');
  zonesEl.innerHTML = '';
  const zoneLabels = mode === 'sort'  ? g.categories
                   : mode === 'order' ? g.zones
                   : shuffle(g.items.map(it => it.zone));
  zoneLabels.forEach(label => {
    const el = document.createElement('div');
    el.className    = 'zone';
    el.dataset.label = label;
    el.innerHTML = `<div class="zone-lbl">${label}</div><div class="zone-val">buraya bÄ±rak</div>`;
    zonesEl.appendChild(el);
  });
}

function onDrop(tokenEl, zoneEl) {
  const name  = tokenEl.dataset.name;
  const label = zoneEl.dataset.label;

  if (state.pairs[name] === label) {
    state.score++;  state.correct++;
    tokenEl.classList.add('used');
    zoneEl.querySelector('.zone-val').textContent = name;
    zoneEl.classList.add('correct');
    document.getElementById('scoreEl').textContent    = state.score * 10;
    document.getElementById('progressEl').style.width = (state.correct / state.total * 100) + '%';
    if (state.correct >= state.total) {
      setTimeout(() => toast('ðŸŽ‰ Tebrikler! Puan: ' + state.score * 10, 'win'), 200);
      window.parent.postMessage({ type: 'GAME_COMPLETE', score: state.score * 10 }, '*');
    }
  } else {
    zoneEl.classList.add('wrong');
    setTimeout(() => zoneEl.classList.remove('wrong'), 400);
    toast('âœ— YanlÄ±ÅŸ, tekrar dene!', 'lose');
    window.parent.postMessage({ type: 'GAME_WRONG', token: name, zone: label }, '*');
  }
}

function toast(msg, type) {
  const el = document.getElementById('toast');
  el.textContent = msg;
  el.className   = 'show ' + type;
  clearTimeout(el._t);
  el._t = setTimeout(() => el.className = '', 2000);
}

document.getElementById('tokens').addEventListener('pointerdown', e => {
  const token = e.target.closest('.token');
  if (!token || token.classList.contains('used')) return;
  e.preventDefault();
  draggingEl = token;
  ghost.textContent   = token.dataset.name;
  ghost.style.display = 'block';
  token.classList.add('dragging');

  const move = ev => {
    const cx = ev.clientX ?? ev.touches?.[0]?.clientX;
    const cy = ev.clientY ?? ev.touches?.[0]?.clientY;
    ghost.style.left = cx + 'px';
    ghost.style.top  = cy + 'px';
    document.querySelectorAll('.zone').forEach(z => {
      const r = z.getBoundingClientRect();
      z.classList.toggle('over', cx >= r.left && cx <= r.right && cy >= r.top && cy <= r.bottom);
    });
  };

  const up = ev => {
    ghost.style.display = 'none';
    if (draggingEl) draggingEl.classList.remove('dragging');
    const cx = ev.clientX ?? ev.changedTouches?.[0]?.clientX;
    const cy = ev.clientY ?? ev.changedTouches?.[0]?.clientY;
    document.querySelectorAll('.zone').forEach(z => {
      const r = z.getBoundingClientRect();
      if (cx >= r.left && cx <= r.right && cy >= r.top && cy <= r.bottom) onDrop(draggingEl, z);
      z.classList.remove('over');
    });
    draggingEl = null;
    document.removeEventListener('pointermove', move);
    document.removeEventListener('pointerup', up);
  };

  document.addEventListener('pointermove', move, { passive: false });
  document.addEventListener('pointerup', up);
});

document.querySelectorAll('.mode-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    init(btn.dataset.mode);
  });
});

document.getElementById('resetBtn').addEventListener('click', () => {
  init(document.querySelector('.mode-btn.active')?.dataset.mode || 'match');
});

init('match');
</script>
</body>
</html>
